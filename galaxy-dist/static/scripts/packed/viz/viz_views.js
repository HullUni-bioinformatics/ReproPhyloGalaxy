define(["libs/underscore"],function(a){var b=Backbone.View.extend({className:"track-header",initialize:function(){this.model.config.get("name").on("change:value",this.update_name,this);this.render()},render:function(){this.$el.append($("<div/>").addClass(this.model.drag_handle_class));this.$el.append($("<div/>").addClass("track-name").text(this.model.config.get_value("name")));this.action_icons={};this.render_action_icons();this.$el.dblclick(function(c){c.stopPropagation()});this.$el.append($("<div style='clear: both'/>"))},update_name:function(){this.$el.find(".track-name").text(this.model.config.get_value("name"))},render_action_icons:function(){var c=this;this.icons_div=$("<div/>").addClass("track-icons").hide().appendTo(this.$el);a.each(this.model.action_icons_def,function(d){c.add_action_icon(d.name,d.title,d.css_class,d.on_click_fn,d.prepend,d.hide)});this.set_display_modes(this.model.display_modes)},add_action_icon:function(e,i,h,g,d,f){var c=this;this.action_icons[e]=$("<a/>").attr("title",i).addClass("icon-button").addClass(h).tooltip().click(function(){g(c.model)}).appendTo(this.icons_div);if(f){this.action_icons[e].hide()}},set_display_modes:function(g,k){if(!g){return}this.model.display_modes=g;this.model.mode=(k||this.model.config.get_value("mode")||this.model.display_modes[0]);this.action_icons.mode_icon.attr("title","Set display mode (now: "+this.mode+")");var e=this,d=this.model,h={};for(var f=0,c=d.display_modes.length;f<c;f++){var j=d.display_modes[f];h[j]=function(i){return function(){d.change_mode(i)}}(j)}make_popupmenu(this.action_icons.mode_icon,h)}});return{TrackHeaderView:b}});